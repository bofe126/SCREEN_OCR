# ScreenOCR å¾…åŠäº‹é¡¹

## ğŸš€ å¾…å¼€å‘åŠŸèƒ½

### 1. ç¨‹åºå¼€å¯æç¤ºç•Œé¢

**ä¼˜å…ˆçº§ï¼š** ä¸­

**æè¿°ï¼š**
- åœ¨ç¨‹åºå¯åŠ¨æ—¶æ˜¾ç¤ºæ¬¢è¿æç¤ºç•Œé¢
- è¯´æ˜å¿«æ·é”®å’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•
- å¯é€‰æ‹©"ä¸å†æ˜¾ç¤º"é€‰é¡¹

**æŠ€æœ¯è¦ç‚¹ï¼š**
- ä½¿ç”¨ tkinter åˆ›å»ºæ¬¢è¿çª—å£
- ä¿å­˜ç”¨æˆ·çš„"ä¸å†æ˜¾ç¤º"åå¥½åˆ° config.json
- æ˜¾ç¤ºå½“å‰ OCR å¼•æ“çŠ¶æ€

**ç›¸å…³æ–‡ä»¶ï¼š**
- `screen_ocr_overlay.py` - ä¸»ç¨‹åºå…¥å£
- `config.json` - å­˜å‚¨ç”¨æˆ·åå¥½

---

### 2. æ–‡æœ¬é€‰æ‹©æ–¹å¼æ”¹è¿›

**ä¼˜å…ˆçº§ï¼š** é«˜

**å½“å‰çŠ¶æ€ï¼š**
- âœ… ç°åœ¨ï¼šä½¿ç”¨çŸ©å½¢æ¡†é€‰æ‹©æ–‡æœ¬å—
- âŒ é—®é¢˜ï¼šæ— æ³•ç²¾ç¡®é€‰æ‹©å•ä¸ªæ–‡å­—æˆ–ç‰¹å®šæ–‡æœ¬

**ç›®æ ‡ï¼š**
- æ”¹ä¸ºæŒ‰ç…§ OCR è¯†åˆ«å‡ºçš„æ–‡æ¡£ç»“æ„é€‰æ‹©
- æ”¯æŒæŒ‰è¡Œé€‰æ‹©ã€æŒ‰æ®µè½é€‰æ‹©
- æ”¯æŒé¼ æ ‡æ‹–æ‹½é€‰æ‹©å¤šä¸ªè¿ç»­æ–‡æœ¬å—
- æ”¯æŒ Ctrl+ç‚¹å‡»é€‰æ‹©å¤šä¸ªä¸è¿ç»­æ–‡æœ¬å—

**æŠ€æœ¯æ–¹æ¡ˆï¼š**
```python
# é€‰æ‹©æ¨¡å¼ï¼š
# 1. å•æ–‡æœ¬å—ç‚¹å‡»ï¼ˆå½“å‰ï¼‰
# 2. æ–‡æœ¬è¡Œé€‰æ‹©ï¼ˆæ–°å¢ï¼‰
# 3. æ®µè½é€‰æ‹©ï¼ˆæ–°å¢ï¼‰
# 4. æ‹–æ‹½å¤šé€‰ï¼ˆæ–°å¢ï¼‰
# 5. Ctrl+å¤šé€‰ï¼ˆæ–°å¢ï¼‰
```

**UI è®¾è®¡ï¼š**
- é¼ æ ‡æ‚¬åœæ—¶é«˜äº®æ˜¾ç¤ºå¯é€‰æ–‡æœ¬
- å·²é€‰æ–‡æœ¬ä½¿ç”¨ä¸åŒé¢œè‰²æ ‡è¯†
- åº•éƒ¨æ˜¾ç¤ºé€‰æ‹©æ¨¡å¼åˆ‡æ¢æŒ‰é’®

**ç›¸å…³æ–‡ä»¶ï¼š**
- `screen_ocr_overlay.py` - é€‰æ‹©é€»è¾‘ä¸»è¦åœ¨ `OverlayWindow` ç±»
- éœ€è¦é‡æ„ `on_text_click()` æ–¹æ³•
- æ·»åŠ  `on_text_hover()` æ–¹æ³•

---

### 3. é€‰æ‹©åçš„æ“ä½œæŒ‰é’®

**ä¼˜å…ˆçº§ï¼š** é«˜

**æè¿°ï¼š**
- åœ¨é€‰æ‹©æ–‡æœ¬åï¼Œæ˜¾ç¤ºæµ®åŠ¨æ“ä½œæŒ‰é’®
- æä¾›å¸¸ç”¨æ–‡æœ¬æ“ä½œåŠŸèƒ½

**åŠŸèƒ½åˆ—è¡¨ï¼š**
1. **ğŸ“‹ å¤åˆ¶** - å¤åˆ¶é€‰ä¸­çš„æ–‡æœ¬ï¼ˆå½“å‰å·²æœ‰ï¼‰
2. **ğŸŒ ç¿»è¯‘** - è°ƒç”¨ç¿»è¯‘ API ç¿»è¯‘é€‰ä¸­æ–‡æœ¬
   - æ”¯æŒå¤šç§ç¿»è¯‘å¼•æ“ï¼ˆç™¾åº¦ã€æœ‰é“ã€DeepLç­‰ï¼‰
   - æ˜¾ç¤ºç¿»è¯‘ç»“æœå¼¹çª—
3. **ğŸ¤– AI å¤„ç†** - è°ƒç”¨ AI API å¤„ç†æ–‡æœ¬
   - æ–‡æœ¬æ€»ç»“
   - æ–‡æœ¬æ¶¦è‰²
   - é—®ç­”å¯¹è¯
   - å¯é…ç½® APIï¼ˆOpenAIã€Claudeã€é€šä¹‰åƒé—®ç­‰ï¼‰
4. **ğŸ” æœç´¢** - ä½¿ç”¨é€‰ä¸­æ–‡æœ¬æœç´¢
   - ç™¾åº¦æœç´¢
   - Google æœç´¢
5. **ğŸ’¾ ä¿å­˜** - ä¿å­˜åˆ°æ–‡ä»¶æˆ–ç¬”è®°åº”ç”¨
   - ä¿å­˜ä¸º TXT
   - å¤åˆ¶åˆ°å‰ªè´´æ¿å†å²
6. **ğŸ“ ç¼–è¾‘** - æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨

**UI è®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·²é€‰æ‹©æ–‡æœ¬ï¼šè¿™æ˜¯è¯†åˆ«å‡ºçš„æ–‡å­—...      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å¤åˆ¶] [ç¿»è¯‘â–¼] [AIâ–¼] [æœç´¢â–¼] [ä¿å­˜] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€æœ¯å®ç°ï¼š**
```python
class ActionButtons:
    """é€‰æ‹©åçš„æ“ä½œæŒ‰é’®"""
    
    def __init__(self, parent, selected_text):
        self.parent = parent
        self.text = selected_text
        
    def create_buttons(self):
        # åˆ›å»ºæŒ‰é’®é¢æ¿
        pass
        
    def on_translate(self):
        # ç¿»è¯‘åŠŸèƒ½
        # 1. æ£€æµ‹è¯­è¨€
        # 2. è°ƒç”¨ç¿»è¯‘ API
        # 3. æ˜¾ç¤ºç»“æœ
        pass
        
    def on_ai_process(self):
        # AI å¤„ç†èœå•
        # 1. æ˜¾ç¤º AI æ“ä½œå­èœå•
        # 2. è°ƒç”¨å¯¹åº”çš„ AI åŠŸèƒ½
        pass
        
    def on_search(self):
        # æœç´¢åŠŸèƒ½
        pass
```

**é…ç½®æ–‡ä»¶æ‰©å±•ï¼š**
```json
{
  "translation": {
    "enabled": true,
    "engine": "baidu",  // baidu, youdao, deepl
    "api_key": "",
    "api_secret": "",
    "auto_detect": true,
    "target_lang": "zh"
  },
  "ai": {
    "enabled": true,
    "provider": "openai",  // openai, claude, qwen
    "api_key": "",
    "api_base": "https://api.openai.com/v1",
    "model": "gpt-3.5-turbo",
    "functions": [
      "summarize",    // æ€»ç»“
      "polish",       // æ¶¦è‰²
      "explain",      // è§£é‡Š
      "translate"     // AI ç¿»è¯‘
    ]
  },
  "search": {
    "default_engine": "baidu",
    "engines": {
      "baidu": "https://www.baidu.com/s?wd=",
      "google": "https://www.google.com/search?q="
    }
  }
}
```

**ç›¸å…³æ–‡ä»¶ï¼š**
- `screen_ocr_overlay.py` - æ·»åŠ æŒ‰é’®é¢æ¿
- æ–°å»º `action_buttons.py` - æ“ä½œæŒ‰é’®ç±»
- æ–°å»º `translation.py` - ç¿»è¯‘åŠŸèƒ½
- æ–°å»º `ai_processor.py` - AI å¤„ç†åŠŸèƒ½
- `config.json` - æ‰©å±•é…ç½®

---

### 4. è‹±æ–‡æ–‡æœ¬åˆ†è¯ä¼˜åŒ–

**ä¼˜å…ˆçº§ï¼š** é«˜

**å½“å‰é—®é¢˜ï¼š**
- âŒ OCR è¯†åˆ«åçš„è‹±æ–‡å•è¯é»åœ¨ä¸€èµ·ï¼Œæ²¡æœ‰ç©ºæ ¼
- âŒ ä¾‹å¦‚ï¼š`HelloWorld` è€Œä¸æ˜¯ `Hello World`
- âŒ å½±å“æ–‡æœ¬å¯è¯»æ€§å’Œåç»­å¤„ç†ï¼ˆç¿»è¯‘ã€æœç´¢ç­‰ï¼‰

**é—®é¢˜åŸå› åˆ†æï¼š**
1. **OCR å¼•æ“é—®é¢˜**ï¼š
   - WeChatOCR å¯¹è‹±æ–‡å•è¯é—´è·è¯†åˆ«ä¸å‡†ç¡®
   - å¯èƒ½å°†ç›¸é‚»çš„è‹±æ–‡å•è¯è¯†åˆ«ä¸ºä¸€ä¸ªæ–‡æœ¬å—
   
2. **æ–‡æœ¬æ‹¼æ¥é—®é¢˜**ï¼š
   - åœ¨åˆå¹¶å¤šä¸ªæ–‡æœ¬å—æ—¶ï¼Œç¼ºå°‘ç©ºæ ¼å¤„ç†
   - è‹±æ–‡å’Œä¸­æ–‡æ··æ’æ—¶çš„ç©ºæ ¼å¤„ç†ä¸å½“

**è§£å†³æ–¹æ¡ˆï¼š**

#### æ–¹æ¡ˆ 1ï¼šOCR åæ™ºèƒ½åˆ†è¯ï¼ˆæ¨èï¼‰
```python
def split_english_words(text):
    """
    ä½¿ç”¨ NLP å·¥å…·å¯¹é»è¿çš„è‹±æ–‡è¿›è¡Œåˆ†è¯
    """
    import re
    
    # 1. æ£€æµ‹è¿ç»­çš„è‹±æ–‡å­—æ¯ï¼ˆæ— ç©ºæ ¼ï¼‰
    # 2. ä½¿ç”¨è¯å…¸æˆ– AI æ¨¡å‹è¿›è¡Œåˆ†è¯
    # 3. åœ¨é€‚å½“ä½ç½®æ’å…¥ç©ºæ ¼
    
    # ç¤ºä¾‹ï¼šä½¿ç”¨ wordninja åº“
    # pip install wordninja
    import wordninja
    
    def process_text(text):
        # æ£€æµ‹é»è¿çš„è‹±æ–‡
        pattern = r'[a-zA-Z]{15,}'  # 15ä¸ªå­—ç¬¦ä»¥ä¸Šçš„è¿ç»­è‹±æ–‡
        
        def split_match(match):
            word = match.group()
            # ä½¿ç”¨ wordninja åˆ†è¯
            return ' '.join(wordninja.split(word))
        
        return re.sub(pattern, split_match, text)
    
    return process_text(text)
```

#### æ–¹æ¡ˆ 2ï¼šOCR è¯†åˆ«æ—¶æ·»åŠ ç©ºæ ¼è§„åˆ™
```python
def merge_text_blocks_with_spacing(blocks):
    """
    åˆå¹¶æ–‡æœ¬å—æ—¶æ™ºèƒ½æ·»åŠ ç©ºæ ¼
    """
    result = []
    
    for i, block in enumerate(blocks):
        text = block['text']
        result.append(text)
        
        # å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå—
        if i < len(blocks) - 1:
            next_block = blocks[i + 1]
            
            # åˆ¤æ–­æ˜¯å¦éœ€è¦æ·»åŠ ç©ºæ ¼
            if should_add_space(block, next_block):
                result.append(' ')
    
    return ''.join(result)

def should_add_space(block1, block2):
    """
    åˆ¤æ–­ä¸¤ä¸ªæ–‡æœ¬å—ä¹‹é—´æ˜¯å¦éœ€è¦ç©ºæ ¼
    """
    text1 = block1['text'].strip()
    text2 = block2['text'].strip()
    
    # å¦‚æœä¸¤ä¸ªéƒ½æ˜¯è‹±æ–‡
    if is_english(text1[-1]) and is_english(text2[0]):
        # è®¡ç®—æ°´å¹³è·ç¦»
        distance = block2['box'][0][0] - block1['box'][1][0]
        avg_char_width = (block1['box'][1][0] - block1['box'][0][0]) / len(text1)
        
        # å¦‚æœè·ç¦»å¤§äºåŠä¸ªå­—ç¬¦å®½åº¦ï¼Œæ·»åŠ ç©ºæ ¼
        if distance > avg_char_width * 0.5:
            return True
    
    return False

def is_english(char):
    """æ£€æŸ¥æ˜¯å¦æ˜¯è‹±æ–‡å­—ç¬¦"""
    return 'a' <= char.lower() <= 'z'
```

#### æ–¹æ¡ˆ 3ï¼šä½¿ç”¨æ›´å¥½çš„ OCR å¼•æ“
```python
# åˆ‡æ¢åˆ° PaddleOCR æˆ– Tesseract
# è¿™äº›å¼•æ“å¯¹è‹±æ–‡çš„ç©ºæ ¼å¤„ç†æ›´å¥½
config = {
    "ocr_engine": "paddle",  # æˆ– "tesseract"
    "paddle_lang": "en",     # è‹±æ–‡æ¨¡å¼
}
```

**å®ç°æ­¥éª¤ï¼š**
1. åœ¨ `screen_ocr_overlay.py` æ·»åŠ æ–‡æœ¬åå¤„ç†å‡½æ•°
2. åœ¨ OCR ç»“æœè¿”å›åï¼Œè°ƒç”¨åˆ†è¯å‡½æ•°
3. æ·»åŠ é…ç½®é€‰é¡¹ï¼Œå…è®¸ç”¨æˆ·å¼€å¯/å…³é—­è‡ªåŠ¨åˆ†è¯
4. å¯¹ä¸­è‹±æ–‡æ··æ’è¿›è¡Œç‰¹æ®Šå¤„ç†

**æŠ€æœ¯ä¾èµ–ï¼š**
```bash
# å®‰è£…åˆ†è¯åº“
pip install wordninja  # è‹±æ–‡åˆ†è¯
# æˆ–
pip install nltk       # æ›´å¼ºå¤§çš„ NLP å·¥å…·
```

**é…ç½®æ–‡ä»¶æ‰©å±•ï¼š**
```json
{
  "text_processing": {
    "auto_split_english": true,
    "min_word_length": 15,  // è¶…è¿‡æ­¤é•¿åº¦æ‰å°è¯•åˆ†è¯
    "add_space_between_blocks": true,
    "space_threshold": 0.5  // å­—ç¬¦å®½åº¦çš„å€æ•°
  }
}
```

**æµ‹è¯•ç”¨ä¾‹ï¼š**
```python
# è¾“å…¥ï¼šHelloWorldThisIsATest
# è¾“å‡ºï¼šHello World This Is A Test

# è¾“å…¥ï¼šæˆ‘ä»Šå¤©å»äº†Shopping Mall
# è¾“å‡ºï¼šæˆ‘ä»Šå¤©å»äº† Shopping Mall

# è¾“å…¥ï¼šOpenAIGPT-4
# è¾“å‡ºï¼šOpenAI GPT-4
```

**ç›¸å…³æ–‡ä»¶ï¼š**
- `screen_ocr_overlay.py` - æ·»åŠ æ–‡æœ¬åå¤„ç†
- æ–°å»º `text_processor.py` - æ–‡æœ¬å¤„ç†å·¥å…·
- `wechat_ocr_wrapper.py` - å¯èƒ½éœ€è¦è°ƒæ•´æ–‡æœ¬å—åˆå¹¶é€»è¾‘
- `config.json` - æ·»åŠ åˆ†è¯é…ç½®

**ä¼˜å…ˆçº§è¯´æ˜ï¼š**
æ­¤é—®é¢˜ä¸¥é‡å½±å“è‹±æ–‡å†…å®¹çš„å¯è¯»æ€§ï¼Œå»ºè®®ä¼˜å…ˆè§£å†³ã€‚

---

## ğŸ“‹ æŠ€æœ¯å€ºåŠ¡

- [ ] é‡æ„ OCR åˆå§‹åŒ–é€»è¾‘ï¼ˆå·²å®Œæˆå¼‚æ­¥ä¼˜åŒ–ï¼‰
- [ ] ä¼˜åŒ–å¤§å›¾ç‰‡çš„ OCR å¤„ç†é€Ÿåº¦
- [ ] æ·»åŠ é”™è¯¯æ—¥å¿—è®°å½•
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–

## ğŸ› å·²çŸ¥é—®é¢˜

- [x] pystray èœå•ä½ç½®é”™è¯¯ï¼ˆå·²é€šè¿‡è‡ªåŠ¨ä¿®å¤è„šæœ¬è§£å†³ï¼‰
- [x] å¯åŠ¨é€Ÿåº¦æ…¢ï¼ˆå·²ä¼˜åŒ–ï¼‰
- [ ] é«˜ DPI ä¸‹æ–‡æœ¬ä½ç½®åç§»

## ğŸ“¦ æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒæˆªå›¾ç¼–è¾‘åŠŸèƒ½
- [ ] æ”¯æŒ OCR å†å²è®°å½•
- [ ] æ”¯æŒå¤šæ˜¾ç¤ºå™¨
- [ ] æ”¯æŒ PDF æ–‡ä»¶ OCR
- [ ] æ’ä»¶ç³»ç»Ÿï¼ˆå…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ“ä½œæŒ‰é’®ï¼‰

---

## ä¼˜å…ˆçº§è¯´æ˜

- **é«˜**ï¼šå½±å“ç”¨æˆ·ä½“éªŒï¼Œéœ€è¦ä¼˜å…ˆå®ç°
- **ä¸­**ï¼šæ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥ç¨åå®ç°
- **ä½**ï¼šé”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½

## ç‰ˆæœ¬è§„åˆ’

### v1.1.0ï¼ˆä¸‹ä¸€ç‰ˆæœ¬ï¼‰
- [x] ç¨‹åºå¯åŠ¨é€Ÿåº¦ä¼˜åŒ–
- [x] å›¾æ ‡ä¼˜åŒ–
- [x] pystray èœå•ä½ç½®ä¿®å¤
- [ ] è‹±æ–‡æ–‡æœ¬åˆ†è¯ä¼˜åŒ– ğŸ”¥
- [ ] æ–‡æœ¬é€‰æ‹©æ–¹å¼æ”¹è¿›
- [ ] é€‰æ‹©åçš„æ“ä½œæŒ‰é’®ï¼ˆåŸºç¡€ç‰ˆï¼šå¤åˆ¶ã€ç¿»è¯‘ã€æœç´¢ï¼‰

### v1.2.0ï¼ˆæœªæ¥ï¼‰
- [ ] ç¨‹åºå¼€å¯æç¤ºç•Œé¢
- [ ] AI åŠŸèƒ½é›†æˆ
- [ ] OCR å†å²è®°å½•

### v2.0.0ï¼ˆè¿œæœŸï¼‰
- [ ] æ’ä»¶ç³»ç»Ÿ
- [ ] PDF æ”¯æŒ
- [ ] æˆªå›¾ç¼–è¾‘

---

*æœ€åæ›´æ–°ï¼š2025-11-03*

